<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>AiCompanion</title>
    <style>
      .settings-modal-hidden {
        display: none;
      }
      .settings-modal-visible {
        display: block;
      }
      .floating-chat-message.assistant {
        transition: opacity 0.3s ease-out, transform 0.3s ease-out;
        transform: translate(-50%, -100%); /* 최종 위치 */
      }
      .floating-chat-message.assistant.entering {
        opacity: 0;
        transform: translate(-60%, -100%); /* 왼쪽에서 시작 */
      }
    </style>
  </head>
  <body>
    <div id="top-buttons-container" style="position: fixed; top: 24px; right: 32px; z-index: 1000; display: flex; justify-content: flex-end; align-items: center; gap: 10px;">
      <button id="open-settings" style="background: rgba(0,0,0,0.5); color: #fff; border: none; border-radius: 4px; font-size: 1.1rem; padding: 0.5rem 1rem; cursor: pointer;">설정</button>
      <button id="open-joint-control" style="background: rgba(0,0,0,0.5); color: #fff; border: none; border-radius: 4px; font-size: 1.1rem; padding: 0.5rem 1rem; cursor: pointer;">관절 조절</button>
      <button id="open-expression-panel-button" style="background: rgba(0,0,0,0.5); color: #fff; border: none; border-radius: 4px; font-size: 1.1rem; padding: 0.5rem 1rem; cursor: pointer;">표정</button>
      <button id="open-modules-panel-button" style="background: rgba(0,0,0,0.5); color: #fff; border: none; border-radius: 4px; font-size: 1.1rem; padding: 0.5rem 1rem; cursor: pointer;">모듈</button>
      <button id="open-mesh-panel-button" style="background: rgba(0,0,0,0.5); color: #fff; border: none; border-radius: 4px; font-size: 1.1rem; padding: 0.5rem 1rem; cursor: pointer;">메쉬</button>
      <button id="close-overlay" style="background: rgba(0,0,0,0.5); color: #fff; border: none; border-radius: 4px; font-size: 1.5rem; padding: 0.5rem 1rem; cursor: pointer;">×</button>
    </div>
    <div id="settings-modal" style="visibility:hidden; opacity:0; transition: opacity 0.3s ease, visibility 0.3s ease; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 600px; height: 400px; background: rgba(20,20,20,0.95); z-index: 2001; padding: 20px; border-radius: 10px; color: #fff; overflow-y: auto; box-shadow: 0 0 20px rgba(0,0,0,0.5);">
      <button id="close-settings" style="position: absolute; top: 10px; right: 10px; background: none; border: none; color: #fff; font-size: 1.5rem; cursor: pointer;">×</button>
      <h2 style="margin-top: 0; margin-bottom: 20px; font-size: 1.8rem; text-align: center;">챗봇 LLM API 설정</h2>
      <form id="llm-form" style="display: flex; flex-direction: column; gap: 15px;">
        <label for="llm-api-key" style="font-size: 1.1rem; color: #ccc;">LLM API 키</label>
        <input type="text" id="llm-api-key" name="llm-api-key" placeholder="API 키를 입력하세요" required style="padding: 10px; border: 1px solid #444; border-radius: 5px; background-color: #333; color: #eee; font-size: 1rem;" />
        <button type="submit" style="padding: 12px 20px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 1.1rem; transition: background-color 0.2s ease;">저장</button>
      </form>
      <h2 style="margin-top: 20px; margin-bottom: 20px; font-size: 1.8rem; text-align: center;">페르소나 설정</h2>
      <form id="persona-form" style="display: flex; flex-direction: column; gap: 15px;">
        <label for="persona-text" style="font-size: 1.1rem; color: #ccc;">페르소나 텍스트</label>
        <textarea id="persona-text" name="persona-text" rows="5" placeholder="페르소나를 입력하세요" style="padding: 10px; border: 1px solid #444; border-radius: 5px; background-color: #333; color: #eee; font-size: 1rem; resize: vertical;"></textarea>
        <button type="submit" style="padding: 12px 20px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 1.1rem; transition: background-color 0.2s ease;">저장</button>
        <button type="button" id="load-persona-file-button" style="padding: 12px 20px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 1.1rem; transition: background-color 0.2s ease;">파일에서 불러오기</button>
      </form>
      <h2 style="margin-top: 20px; margin-bottom: 20px; font-size: 1.8rem; text-align: center;">배경 설정</h2>
      <form id="background-form" style="display: flex; flex-direction: column; gap: 15px;">
        <label for="background-color-picker" style="font-size: 1.1rem; color: #ccc;">배경 색상</label>
        <input type="color" id="background-color-picker" name="background-color-picker" value="#36393f" style="width: 100%; height: 40px; border: none; padding: 0;" />
      </form>
      <div id="save-message" style="display:none; color:lightgreen; margin-top:15px; font-size: 0.9rem; text-align: center;">저장되었습니다!</div>
    </div>
    <div id="settings-modal-overlay" style="display:none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 2000; pointer-events: none;"></div>
    <div id="joint-control-panel" style="display:none; position: fixed; top: 80px; right: 20px; width: 300px; max-height: 70vh; background: rgba(20,20,20,0.8); z-index: 2000; padding: 20px; border-radius: 10px; color: #fff; overflow-y: auto;">
      <button id="close-joint-control" style="position: absolute; top: 10px; right: 10px; background: none; border: none; color: #fff; font-size: 1.5rem; cursor: pointer;">×</button>
      <h3>관절 조절</h3>
      <div id="joint-sliders"></div>
    </div>
    <div id="pose-side-panel" style="display:none; position: fixed; top: 0; right: 0; width: 300px; height: 100vh; background: rgba(30,30,30,0.95); z-index: 2000; padding: 25px; color: #fff; overflow-y: auto; box-shadow: -5px 0 15px rgba(0,0,0,0.5);">
      <button id="close-pose-panel" style="position: absolute; top: 10px; right: 10px; background: none; border: none; color: #fff; font-size: 1.5rem; cursor: pointer;">×</button>
      <div id="pose-list-display"></div>
    </div>

    <div id="animation-side-panel" style="display:none; position: fixed; top: 0; right: 0; width: 300px; height: 100vh; background: rgba(30,30,30,0.95); z-index: 2000; padding: 25px; color: #fff; overflow-y: auto; box-shadow: -5px 0 15px rgba(0,0,0,0.5);">
      <button id="close-animation-panel" style="position: absolute; top: 10px; right: 10px; background: none; border: none; color: #fff; font-size: 1.5rem; cursor: pointer;">×</button>
      <div id="animation-list-display"></div>
    </div>

    <div id="expression-control-panel" style="display:none; position: fixed; top: 80px; right: 20px; width: 300px; max-height: 70vh; background: rgba(20,20,20,0.8); z-index: 2000; padding: 20px; border-radius: 10px; color: #fff; overflow-y: auto;">
      <button id="close-expression-panel" style="position: absolute; top: 10px; right: 10px; background: none; border: none; color: #fff; font-size: 1.5rem; cursor: pointer;">×</button>
      <h3>표정 조절</h3>
      <div id="expression-sliders"></div>
    </div>
    <div id="module-control-panel" style="display:none; position: fixed; top: 80px; right: 20px; width: 300px; max-height: 70vh; background: rgba(20,20,20,0.8); z-index: 2000; padding: 20px; border-radius: 10px; color: #fff; overflow-y: auto;">
      <button id="close-modules-panel" style="position: absolute; top: 10px; right: 10px; background: none; border: none; color: #fff; font-size: 1.5rem; cursor: pointer;">×</button>
      <h3>모듈 관리</h3>
      <div id="modules-list"></div>
    </div>
    <div id="mesh-control-panel" style="display:none; position: fixed; top: 80px; right: 20px; width: 300px; max-height: 70vh; background: rgba(20,20,20,0.8); z-index: 2000; padding: 20px; border-radius: 10px; color: #fff; overflow-y: auto;">
      <button id="close-mesh-panel" style="position: absolute; top: 10px; right: 10px; background: none; border: none; color: #fff; font-size: 1.5rem; cursor: pointer;">×</button>
      <h3>메쉬 관리</h3>
      <div id="mesh-list"></div>
    </div>
    <div id="animation-buttons" style="position: fixed; top: 50%; left: 20px; transform: translateY(-50%); z-index: 9999; display: flex; flex-direction: column; gap: 5px; background-color: rgba(0,0,0,0.3); padding: 10px; border-radius: 0px;">
      <!-- VRM 모델 관련 -->
      <button id="load-vrm-button" style="padding: 10px; background-color: #34495e; color: white; border: none; border-radius: 0px; cursor: pointer;">VRM 모델 로드</button>
      
      <!-- 포즈/애니메이션 패널 열기 -->
      <button id="open-pose-panel-button" style="padding: 10px; background-color: #6a9955; color: white; border: none; border-radius: 0px; cursor: pointer;">포즈 열기</button>
      <button id="open-animation-panel-button" style="padding: 10px; background-color: #6a9955; color: white; border: none; border-radius: 0px; cursor: pointer;">애니메이션 열기</button>

      <!-- 포즈 관련 -->
      <button id="save-pose-button" style="padding: 10px; background-color: #2c3e50; color: white; border: none; border-radius: 0px; cursor: pointer;">포즈 저장</button>
      <button id="load-pose-file-button" style="padding: 10px; background-color: #2c3e50; color: white; border: none; border-radius: 0px; cursor: pointer;">포즈 파일 열기</button>
    </div>

    <div id="bottom-left-buttons-container" style="position: fixed; bottom: 24px; left: 32px; z-index: 9999; display: flex; flex-direction: column; gap: 5px;">
      <button id="toggle-camera-mode-button" style="padding: 10px; background-color: #888888; color: white; border: none; border-radius: 4px; cursor: pointer;">자유카메라</button>
    </div>

    <div id="chat-container" style="position: fixed; bottom: 8%; z-index: 9999; border-radius: 5px;">
      <div id="chat-messages" style="margin: 0px;"></div>
      <form id="chat-form">
        <input type="text" id="chat-input" placeholder="메시지를 입력하세요..." autocomplete="off" required />
        <button type="submit">전송</button>
      </form>
    </div>
    <div id="floating-chat-messages-container" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9998;"></div>
    <div id="vrm-follow-button" style="position: absolute; background-color: blue; color: white; padding: 10px; border-radius: 5px; cursor: pointer; display: none; transform: translate(-50%, -50%);">
      Follow Button
    </div>
    </body>
</html>
